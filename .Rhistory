data(evals)
glimpse(evals)
d <- evals |>
rename(bty = bty_avg,    # just shorter to type
sex = gender)     # actually what they have
glimpse(d)
head(d)
mod1 <- lm(score ~ bty,
data = d)
get_regression_table(mod1)
mod1_preds <- get_regression_points(mod1)
head(mod1_preds)
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +   #scatter plot
geom_smooth(method = "lm",
se = FALSE) +   #line through the scatter plot
labs(x = "Beauty",
y = "Evaluation",
title = "Simple regression results")
ggplot(mod1_preds,
aes(x = bty,
y = residual)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = 0,
color = "blue") +
labs(x = "Beauty",
y = "Residual",
title = "Simple regression residuals")
var_y <- d |>
pull(score) |>
var()
var_y
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
labs(x = "Beauty",
y = "Evaluation",
title = "Guessing the mean for everyone")
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
geom_smooth(method = "lm",
se = FALSE,
color = "red",
linetype = "dashed") +
labs(x = "Beauty",
y = "Evaluation",
title = "Mean vs. regression line")
var_yhat1 <- mod1_preds |>
pull(residual) |>
var()
var_yhat1
1 - (var_yhat1 / var_y)
broom::glance(mod1)
moderndive::get_regression_summaries(mod1)
#| message: false
library(tidyverse)
library(moderndive)
library(ggthemes)
library(patchwork)
theme_set(theme_light())
data(evals)
glimpse(evals)
d <- evals |>
rename(bty = bty_avg,    # just shorter to type
sex = gender)     # actually what they have
glimpse(d)
head(d)
mod1 <- lm(score ~ bty,
data = d)
get_regression_table(mod1)
mod1_preds <- get_regression_points(mod1)
head(mod1_preds)
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +   #scatter plot
geom_smooth(method = "lm",
se = FALSE) +   #line through the scatter plot
labs(x = "Beauty",
y = "Evaluation",
title = "Simple regression results")
ggplot(mod1_preds,
aes(x = bty,
y = residual)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = 0,
color = "blue") +
labs(x = "Beauty",
y = "Residual",
title = "Simple regression residuals")
var_y <- d |>
pull(score) |>
var()
var_y
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
labs(x = "Beauty",
y = "Evaluation",
title = "Guessing the mean for everyone")
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
geom_smooth(method = "lm",
se = FALSE,
color = "red",
linetype = "dashed") +
labs(x = "Beauty",
y = "Evaluation",
title = "Mean vs. regression line")
var_yhat1 <- mod1_preds |>
pull(residual) |>
var()
var_yhat1
1 - (var_yhat1 / var_y)
broom::glance(mod1)
moderndive::get_regression_summaries(mod1)
#| message: false
library(tidyverse)
library(moderndive)
library(ggthemes)
library(patchwork)
theme_set(theme_light())
data(evals)
glimpse(evals)
d <- evals |>
rename(bty = bty_avg,    # just shorter to type
sex = gender)     # actually what they have
glimpse(d)
head(d)
mod1 <- lm(score ~ bty,
data = d)
get_regression_table(mod1)
mod1_preds <- get_regression_points(mod1)
head(mod1_preds)
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +   #scatter plot
geom_smooth(method = "lm",
se = FALSE) +   #line through the scatter plot
labs(x = "Beauty",
y = "Evaluation",
title = "Simple regression results")
ggplot(mod1_preds,
aes(x = bty,
y = residual)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = 0,
color = "blue") +
labs(x = "Beauty",
y = "Residual",
title = "Simple regression residuals")
var_y <- d |>
pull(score) |>
var()
var_y
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
labs(x = "Beauty",
y = "Evaluation",
title = "Guessing the mean for everyone")
ggplot(d,
aes(x = bty,
y = score)) +
geom_jitter(alpha = .3) +
geom_hline(yintercept = mean(d$score),
color = "blue") +
geom_smooth(method = "lm",
se = FALSE,
color = "red",
linetype = "dashed") +
labs(x = "Beauty",
y = "Evaluation",
title = "Mean vs. regression line")
var_yhat1 <- mod1_preds |>
pull(residual) |>
var()
var_yhat1
1 - (var_yhat1 / var_y)
broom::glance(mod1)
moderndive::get_regression_summaries(mod1)
mod2 <- lm(score ~ sex,
data = d)
get_regression_table(mod2)
get_regression_summaries(mod2)
mod3 <- lm(score ~ bty + sex,
data = d)
get_regression_table(mod3)
library(tidyverse)
# Set our ggplot theme from the outset
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
# Glimpse at the data
glimpse(gender_employment)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, colour=major_category)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
model_summary <- tidy(two_var_model)
library(tidyverse)
# Set our ggplot theme from the outset
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
# Glimpse at the data
glimpse(gender_employment)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
library(dplyr)
library(broom)
parallel_model <- lm(wage_percent_of_male ~ year + major_category, data = gender_employment)
model_summary <- tidy(parallel_model)
summary(parallel_model)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, colour=major_category)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
library(dplyr)
library(broom)
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
model_summary <- tidy(two_var_model)
summary(two_var_model)
library(dplyr)
library(broom)
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
broom::glance(two_var_model)
library(dplyr)
library(broom)
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
get_regression_table(two_var_model)
library(dplyr)
library(broom)
parallel_model <- lm(wage_percent_of_male ~ year + major_category, data = gender_employment)
broom:: tidy(parallel_model)
library(dplyr)
library(broom)
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
broom:: tidy(two_var_model)
broom:: tidy(two_var_model)
= -1370.472+0.72(2016)-1.06(2016)+2137.650
-1370.472+0.72(2016)-1.06(2016)+2137.650
library(dplyr)
library(broom)
simple_fit <- lm(wage_percent_of_male ~ year, data = gender_employment)
broom::tidy(simple_fit)
simple_fit <- lm(wage_percent_of_male ~ year, data = gender_employment)
simple_fit <- lm(wage_percent_of_male ~ year, data = gender_employment)
broom::tidy(simple_fit)
simple_fit_female <- lm(wage_percent_of_female ~ year, data = gender_employment)
gender_employment %>%
select(year, wage_percent_of_male, percent_female) %>%
cor(use = "complete.obs")
multiple_fit <- lm(wage_percent ~ year*percent_female, data = gender_employment)
multiple_fit <- lm(wage_percent_male ~ year*percent_female, data = gender_employment)
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
broom::tidy(multiple_fit)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group= major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment%>%
ggplot(d,
aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
library(tidyverse)
library(moderndive)
# Set our ggplot theme from the outset
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
# Glimpse at the data
glimpse(gender_employment)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
library(dplyr)
library(broom)
parallel_model <- lm(wage_percent_of_male ~ year + major_category, data = gender_employment)
broom:: tidy(parallel_model)
gender_employment%>%
ggplot(d,
aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(gender_employment,
aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(d=gender_employment,
aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(
aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
library(tidyverse)
library(moderndive)
# Set our ggplot theme from the outset
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
# Glimpse at the data
glimpse(gender_employment)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
library(dplyr)
library(broom)
parallel_model <- lm(wage_percent_of_male ~ year + major_category, data = gender_employment)
broom:: tidy(parallel_model)
library(moderndive)
gender_employment%>%
ggplot(aes(x = year(),
y = wage_percent_of_male,
group = major_category,
color = major_category)) +
geom_jitter(alpha = .3) +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
#!warning: false
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
#! warning: false
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
# warning: false
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
ggplot(d=gender_employment,aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
simple_glanced <- glance(simple_fit)
simple_glanced$r.squared
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
results <- broom::tidy(multiple_fit)
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
results <- broom::tidy(multiple_fit) %>% select(term,estimate)
View(results)
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
results <- get_regression_table(multiple_fit) %>% select(term,estimate)
View(results)
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
get_regression_table(multiple_fit) %>% select(term,estimate)
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
get_regression_table(multiple_fit) %>% select(term,estimate)
