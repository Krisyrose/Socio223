gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
# Glimpse at the data
glimpse(gender_employment)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male)) +
geom_jitter(alpha = 0.1) +
geom_smooth(method = "lm") +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
library(dplyr)
library(broom)
parallel_model <- lm(wage_percent_of_male ~ year + major_category, data = gender_employment)
broom:: tidy(parallel_model)
library(moderndive)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
library(dplyr)
library(broom)
two_var_model <- lm(wage_percent_of_male ~ year*major_category, data = gender_employment)
broom:: tidy(two_var_model)
library(dplyr)
library(broom)
simple_fit <- lm(wage_percent_of_male ~ year, data = gender_employment)
broom::tidy(simple_fit)
gender_employment %>%
select(year, wage_percent_of_male, percent_female) %>%
cor(use = "complete.obs")
multiple_fit <- lm(wage_percent_of_male ~ year*percent_female, data = gender_employment)
get_regression_table(multiple_fit) %>% select(term,estimate)
simple_glanced <- glance(simple_fit)
simple_glanced$r.squared
simple_glanced <- glance(multiple_fit)
simple_glanced$r.squared
random_numbers <- rnorm(n = nrow(gender_employment),
mean = 0,
sd = 4)
#| warning: false
library(moderndive)
gender_employment%>%
ggplot(aes(x = year, y = wage_percent_of_male, group = major_category,colour=major_category)) +
geom_jitter(alpha = 0.1) +
labs(title = "Women's earnings with respect to men's",
y = "% of Men's Income",
x = "Year") +
geom_parallel_slopes(se = FALSE) +  # this is a modern dive thing!
theme(legend.position = "top")
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
install.packages(bayesrules)
install.packages(bayesrules)
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
install.packages("bayesrules")
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
View(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(rides,windspeed) %>%
cor(use = "complete.obs")
bikes %>%
mutate(wind_kph,windspeed*1.61)
bikes %>%
mutate(windspeed,windspeed*1.61)
bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
library(tidyverse)
library(moderndive)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
library(tidyverse)
library(moderndive)
library(broom)
theme_set(theme_minimal())
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
intmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
#| message: false
library(tidyverse)
library(moderndive)
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("Data/gender_employment.csv")
#| message: false
library(tidyverse)
library(moderndive)
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("Data/gender_employment.csv")
intmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
#| message: false
library(tidyverse)
library(moderndive)
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("Data/gender_employment.csv")
# Read in the data
gender_employment <- read_csv("Data/gender_employment.csv")
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
#| message: false
library(tidyverse)
library(moderndive)
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
ptmodel <- lm(wage_percent_of_male ~ year + major_category,
data = gender_employment)
intmodel <- lm(wage_percent_of_male ~ year * major_category,
data = gender_employment)
ptmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
intmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
#| message: false
library(tidyverse)
library(moderndive)
theme_set(theme_light())
# Read in the data
gender_employment <- read_csv("https://raw.githubusercontent.com/vaiseys/dav-course/main/Data/gender_employment.csv")
gender_employment <- gender_employment %>%
mutate(major_category = as.factor(major_category),
major_category = relevel(major_category, ref = "Management, Business, and Financial"))
ptmodel <- lm(wage_percent_of_male ~ year + major_category,
data = gender_employment)
intmodel <- lm(wage_percent_of_male ~ year * major_category,
data = gender_employment)
ptmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
intmodel |>
get_regression_table() |>
select(term, estimate)    # just keep what I need
pred_df <- tribble(         # tribble allows easy manual data entry
~year, ~major_category,
2016, "Service"
)
pred_df
predict(ptmodel,
newdata = pred_df)
pred_df <- pred_df |>
mutate(pt_pred = predict(ptmodel, newdata = pred_df),
int_pred = predict(intmodel, newdata = pred_df))
pred_df
pred_df2 <-
expand_grid(
major_category = c("Service", "Sales and Office"),
year = c(2013, 2016)
)
pred_df2
pred_df2 <- pred_df2 |>
mutate(pt_pred = predict(ptmodel, newdata = pred_df2),
int_pred = predict(intmodel, newdata = pred_df2))
pred_df2
rides_MPH %>% bikes <- tribble(         # tribble allows easy manual data entry
~rides, ~windspeed,
, "20"
)
rides_MPH %>% bikes <- tribble(         # tribble allows easy manual data entry
~rides, ~windspeed,
32, "20"
)
bikes <- tribble(         # tribble allows easy manual data entry
~rides, ~windspeed,
, "20"
)
bikes <- tribble(         # tribble allows easy manual data entry
~rides, ~windspeed,
50, "20"
)
bikes
predict_bikes <- tribble(         # tribble allows easy manual data entry
~rides, ~windspeed,
50, "20"
)
predict_bikes
predict(bikes,
newdata = pred_bikes)
predict_bikes <- tribble(         # tribble allows easy manual data entry
~wind_KPH, ~windspeed,
20, 20
)
predict_bikes
predict(bikes,
newdata = pred_bikes)
View(ptmodel)
View(ptmodel)
pred_df <- pred_df |>
mutate(pt_pred = predict(ptmodel, newdata = pred_df),
int_pred = predict(intmodel, newdata = pred_df))
pred_df
bikes <- bikes %>%
mutate(temp_c=((temp_feels-32)*(5/9)))
library(tidyverse)
library(moderndive)
library(broom)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(rides,windspeed) %>%
cor(use = "complete.obs")
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
predict_bikes <- tribble(         # tribble allows easy manual data entry
~wind_KPH, ~windspeed,
20, 20
)
predict_bikes
bikes <- bikes %>%
mutate(temp_c=((temp_feel-32)*(5/9)))
rides_2var_fit <- lm(rides ~ wind_kph+temp_c, data = bikes)
broom::tidy(rides_2var_fit)
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH,
20
)
predict_bikes
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH,
20
)
predict_bikes
library(tidyverse)
library(moderndive)
library(broom)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(rides,windspeed) %>%
cor(use = "complete.obs")
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH,
20
)
pred_df
predict(bikes,
newdata = pred_df)
rides_MPH_fit <- lm(rides ~ windspeed+wind_kph, data = bikes)
broom::tidy(rides_MPH_fit)
rides_MPH_fit <- lm(rides ~ windspeed + wind_kph, data = bikes)
broom::tidy(rides_MPH_fit)
rides_MPH_fit <- lm(rides ~ windspeed+wind_kph, data = bikes)
broom::tidy(rides_MPH_fit)
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit,newdata=pred_df))
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH, ~wind_MPH
20,        0,
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH, ~wind_MPH,
20,        0,
0,        20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
mod_fit <- lm(rides ~ windspeed+wind_kph, data = bikes)
broom::tidy(mod_fit)
mod_fit <- lm(rides ~ windspeed+wind_kph, data = bikes)
broom::tidy(mod_fit)
mod_fit <- lm(rides ~ windspeed+wind_kph, data = bikes)
broom::tidy(mod_fit)
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH, ~wind_MPH,
20,        0,
0,        20
)
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_KPH,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
library(tidyverse)
library(moderndive)
library(broom)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(rides,windspeed) %>%
cor(use = "complete.obs")
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_kph,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_MPH,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_mph,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df <- tribble(         # tribble allows easy manual data entry
~windspeed,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~windspeed,
20
)
pred_df
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~windspeed,
20
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_kph,
20
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~windspeed,
20
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df
library(tidyverse)
library(moderndive)
library(broom)
theme_set(theme_minimal())
data(bikes, package = "bayesrules")
glimpse(bikes)
bikes %>%
select(rides,temp_feel) %>%
cor(use = "complete.obs")
bikes %>%
select(rides,windspeed) %>%
cor(use = "complete.obs")
bikes <- bikes %>%
mutate(wind_kph=windspeed*1.61)
bikes %>%
select(windspeed,wind_kph) %>%
cor(use = "complete.obs")
rides_MPH_fit <- lm(rides ~ windspeed, data = bikes)
broom::tidy(rides_MPH_fit)
rides_KPH_fit <- lm(rides ~ wind_kph, data = bikes)
broom::tidy(rides_KPH_fit)
pred_df <- tribble(         # tribble allows easy manual data entry
~wind_kph,
20
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
pred_df
pred_df <- tribble(         # tribble allows easy manual data entry
~windspeed,
20
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_MPH_fit, newdata = pred_df))
pred_df
pred_df <- tibble(
situation = 1:3,
temp_c = c(25, 15, 10),
wind_kph = c(15, 5, 40)
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_KPH_fit, newdata = pred_df))
pred_df
pred_df <- tibble(
situation = 1:3,
temp_c = c(25, 15, 10),
wind_kph = c(15, 5, 40)
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_2var_fit, newdata = pred_df))
pred_df
rides_3var_fit <- lm(rides ~ wind_kph+temp_c+weekend, data = bikes)
bikes <- bikes %>%
mutate(temp_c=((temp_feel-32)*(5/9)))
pred_df <- tibble(
situation = 1:3,
temp_c = c(25, 15, 10),
wind_kph = c(15, 5, 40)
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_2var_fit, newdata = pred_df))
pred_df
rides_3var_fit <- lm(rides ~ wind_kph+temp_c+weekend, data = bikes)
broom::tidy(rides_3var_fit)
pred_df <- tibble(
situation = 1:2,
weekend = c(TRUE, FALSE)
)
pred_df <- pred_df |>
mutate(expected_rides = predict(rides_3var_fit, newdata = pred_df))
